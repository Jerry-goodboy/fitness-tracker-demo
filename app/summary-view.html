<link rel="import" href="app-theme.html" />
<dom-module id="summary-view">
    <template>
        <style include="app-theme"></style>
        <style>
            :host {
                display: block;
            }
            .h2 span {
                background: var(--text-primary-color);
                color: #fff;
                border-radius: 50%;
                width: 1.8em;
                height: 1.8em;
                line-height: 1.8em;
                display: inline-block;
            }
        </style>
        <app-toolbar>
            <span class="h1">Workouts</span>
            <span class="h2">Selected week <span>[[weekData.weekNumber]]</span></span>
            <span class="details">
                <span>[[_weekStartDate(weekData.weekNumber)]]</span>
                &ndash;
                <span>[[_weekEndDate(weekData.weekNumber)]]</span>
            </span>
        </app-toolbar>
        <button id="prev" on-tap="_prevWeek">Prev week</button>
        <button id="next" on-tap="_nextWeek">Next week</button>
        <summary-rings id="summary" summary-rows="[[weekData.summary]]" on-tap="_showDetails"></summary-rings>
    </template>

    <script>
        Polymer({
            is: 'summary-view',
            behaviors: [
                Polymer.NeonAnimatableBehavior
            ],
            properties: {
                weekData: Array,
                animationConfig: {
                    value: function() {
                        return {
                            'entry': {
                                name: 'slide-from-left-animation',
                                node: this
                            },
                            'exit': {
                                name: 'slide-left-animation',
                                node: this
                            }
                        };
                    }
                }
            },
            _weekStartDate: function(weekNumber) {
                return moment('2015-W' + weekNumber).startOf('week').format('Do MMMM');
            },
            _weekEndDate: function(weekNumber) {
                return moment('2015-W' + weekNumber).endOf('week').format('Do MMMM');
            },
            _nextWeek: function() {
                this.fire('next-week');
            },
            _prevWeek: function() {
                this.fire('prev-week');
            },
            _getTotal: function(summaryRows) {
                console.log('total');
                return summaryRows[0].value + '%';
            },
            _showDetails: function() {
                this.fire('navigate', 'details');
            }
        });
    </script>
</dom-module>
